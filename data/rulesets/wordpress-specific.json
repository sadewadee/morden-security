{
  "metadata": {
    "name": "Comprehensive WordPress Security Rules with 8G Firewall Integration",
    "version": "2.0.0",
    "description": "Advanced WordPress security rules integrating 8G Firewall patterns, bad bot detection, and comprehensive WAF protection",
    "last_updated": "2025-08-04",
    "credits": [
      "Based on 8G Firewall by Jeff Starr - https://perishablepress.com/8g-firewall/",
      "WordPress-specific security patterns"
    ]
  },
  "rules": [
    {
      "id": "WP_001",
      "name": "WordPress Config File Access",
      "pattern": "(wp-config\\.php|wp-config-sample\\.php)",
      "flags": "i",
      "severity": 10,
      "action": "block",
      "message": "Attempt to access WordPress configuration files",
      "enabled": true,
      "category": "file_access"
    },
    {
      "id": "WP_002",
      "name": "Plugin Directory Traversal",
      "pattern": "(\\/wp-content\\/plugins\\/.*\\.\\.\\/)",
      "flags": "i",
      "severity": 9,
      "action": "block",
      "message": "Directory traversal attempt in plugins directory",
      "enabled": true,
      "category": "directory_traversal"
    },
    {
      "id": "WP_003",
      "name": "Theme Directory Traversal",
      "pattern": "(\\/wp-content\\/themes\\/.*\\.\\.\\/)",
      "flags": "i",
      "severity": 9,
      "action": "block",
      "message": "Directory traversal attempt in themes directory",
      "enabled": true,
      "category": "directory_traversal"
    },
    {
      "id": "WP_004",
      "name": "WordPress Admin Brute Force",
      "pattern": "(wp-admin.*wp-login\\.php|wp-login\\.php)",
      "flags": "i",
      "severity": 6,
      "action": "monitor",
      "message": "WordPress admin login attempt detected",
      "enabled": true,
      "category": "brute_force"
    },
    {
      "id": "WP_005",
      "name": "XML-RPC Abuse",
      "pattern": "xmlrpc\\.php",
      "flags": "i",
      "severity": 7,
      "action": "monitor",
      "message": "XML-RPC endpoint access detected",
      "enabled": true,
      "category": "xmlrpc_abuse"
    },
    {
      "id": "WP_006",
      "name": "WordPress Version Disclosure",
      "pattern": "(wp-includes\\/js\\/|wp-content\\/themes\\/.*\\/style\\.css\\?ver=)",
      "flags": "i",
      "severity": 4,
      "action": "monitor",
      "message": "WordPress version disclosure attempt",
      "enabled": true,
      "category": "information_disclosure"
    },
    {
      "id": "WP_007",
      "name": "Plugin Enumeration",
      "pattern": "(wp-content\\/plugins\\/[^\\s]*\\/(readme\\.txt|changelog\\.txt))",
      "flags": "i",
      "severity": 5,
      "action": "monitor",
      "message": "Plugin enumeration attempt detected",
      "enabled": true,
      "category": "enumeration"
    },
    {
      "id": "WP_008",
      "name": "Theme Enumeration",
      "pattern": "(wp-content\\/themes\\/[^\\s]*\\/(readme\\.txt|style\\.css))",
      "flags": "i",
      "severity": 4,
      "action": "monitor",
      "message": "Theme enumeration attempt detected",
      "enabled": true,
      "category": "enumeration"
    },
    {
      "id": "8G_001",
      "name": "8G SQL Injection Protection",
      "pattern": "(\\/\\*|\\*\\/|[';]|\\b(union|select|insert|delete|update|drop|create|alter|exec|execute)\\b)",
      "flags": "i",
      "severity": 9,
      "action": "block",
      "message": "SQL injection attempt detected",
      "enabled": true,
      "category": "sql_injection"
    },
    {
      "id": "8G_002",
      "name": "8G XSS Protection",
      "pattern": "(<script|javascript:|vbscript:|onload|onerror|onclick|onmouseover)",
      "flags": "i",
      "severity": 9,
      "action": "block",
      "message": "Cross-site scripting attempt detected",
      "enabled": true,
      "category": "xss"
    },
    {
      "id": "8G_003",
      "name": "8G Directory Traversal Advanced",
      "pattern": "(\\.\\.\\/|\\.\\.\\/.*\\.\\.|\\/\\.\\.\\/|\\.\\.\\/.*\\.\\.\\/)",
      "flags": "i",
      "severity": 9,
      "action": "block",
      "message": "Advanced directory traversal attempt",
      "enabled": true,
      "category": "directory_traversal"
    },
    {
      "id": "8G_004",
      "name": "8G File Inclusion Protection",
      "pattern": "(php:\\/\\/|file:\\/\\/|data:\\/\\/|expect:\\/\\/|zip:\\/\\/)",
      "flags": "i",
      "severity": 9,
      "action": "block",
      "message": "File inclusion attempt detected",
      "enabled": true,
      "category": "file_inclusion"
    },
    {
      "id": "8G_005",
      "name": "8G Command Injection Protection",
      "pattern": "(\\||&&|;|`|\\$\\(|\\{.*\\}|\\\\x[0-9a-f]{2})",
      "flags": "i",
      "severity": 9,
      "action": "block",
      "message": "Command injection attempt detected",
      "enabled": true,
      "category": "command_injection"
    },
    {
      "id": "BOT_001",
      "name": "Bad Bot Detection - Malicious Crawlers",
      "pattern": "(ahrefs|semrush|majestic|moz\\.com|screaming)",
      "flags": "i",
      "severity": 6,
      "action": "block",
      "message": "Malicious crawler bot detected",
      "enabled": true,
      "category": "bad_bots"
    },
    {
      "id": "BOT_002",
      "name": "Bad Bot Detection - Scraping Bots",
      "pattern": "(wget|curl|libwww|lwp|python|perl|java|bot|crawler|spider)",
      "flags": "i",
      "severity": 5,
      "action": "monitor",
      "message": "Scraping bot detected",
      "enabled": true,
      "category": "bad_bots"
    },
    {
      "id": "BOT_003",
      "name": "Bad Bot Detection - Attack Tools",
      "pattern": "(nikto|nmap|masscan|sqlmap|burp|havij|pangolin)",
      "flags": "i",
      "severity": 10,
      "action": "block",
      "message": "Security scanning tool detected",
      "enabled": true,
      "category": "bad_bots"
    },
    {
      "id": "BOT_004",
      "name": "Bad Bot Detection - Suspicious User Agents",
      "pattern": "(censysinspect|shodan|zgrab|masscan|netsparker)",
      "flags": "i",
      "severity": 8,
      "action": "block",
      "message": "Suspicious reconnaissance bot detected",
      "enabled": true,
      "category": "bad_bots"
    },
    {
      "id": "8G_006",
      "name": "8G Malicious Query String",
      "pattern": "(\\.\\.%2f|%2e%2e%2f|%2e%2e/|\\.\\.\\\\|%2e%2e%5c)",
      "flags": "i",
      "severity": 8,
      "action": "block",
      "message": "Malicious query string detected",
      "enabled": true,
      "category": "malicious_request"
    },
    {
      "id": "8G_007",
      "name": "8G HTTP Cookie Protection",
      "pattern": "(\\<\\?|\\?\\>|\\<\\%|\\%\\>|\\<script|javascript:|vbscript:)",
      "flags": "i",
      "severity": 8,
      "action": "block",
      "message": "Malicious HTTP cookie detected",
      "enabled": true,
      "category": "cookie_injection"
    },
    {
      "id": "WP_009",
      "name": "WordPress Core File Access",
      "pattern": "(wp-includes.*\\.php|wp-admin\\/includes.*\\.php|wp-content\\/index\\.php)",
      "flags": "i",
      "severity": 8,
      "action": "block",
      "message": "Direct access to WordPress core files",
      "enabled": true,
      "category": "file_access"
    },
    {
      "id": "WP_010",
      "name": "WordPress Debug Log Access",
      "pattern": "(debug\\.log|error_log|\\.log)",
      "flags": "i",
      "severity": 7,
      "action": "block",
      "message": "Attempt to access log files",
      "enabled": true,
      "category": "information_disclosure"
    },
    {
      "id": "8G_008",
      "name": "8G PHP Code Injection",
      "pattern": "(\\<\\?php|\\<\\?=|eval\\(|base64_decode\\(|file_get_contents\\()",
      "flags": "i",
      "severity": 10,
      "action": "block",
      "message": "PHP code injection attempt",
      "enabled": true,
      "category": "code_injection"
    },
    {
      "id": "8G_009",
      "name": "8G SSRF Protection",
      "pattern": "(127\\.0\\.0\\.1|localhost|0x7f|\\[::\\]|metadata\\.google|169\\.254)",
      "flags": "i",
      "severity": 9,
      "action": "block",
      "message": "Server-Side Request Forgery attempt",
      "enabled": true,
      "category": "ssrf"
    },
    {
      "id": "WP_011",
      "name": "WordPress Upload Directory Access",
      "pattern": "(wp-content\\/uploads\\/.*\\.(php|phtml|php3|php4|php5|pht))",
      "flags": "i",
      "severity": 9,
      "action": "block",
      "message": "Malicious file upload attempt",
      "enabled": true,
      "category": "file_upload"
    },
    {
      "id": "BOT_005",
      "name": "AI Bot Detection",
      "pattern": "(openai|chatgpt|claude|bard|gptbot)",
      "flags": "i",
      "severity": 4,
      "action": "monitor",
      "message": "AI bot access detected",
      "enabled": true,
      "category": "ai_bots"
    },
    {
      "id": "8G_010",
      "name": "8G Encoding Attack Protection",
      "pattern": "(%00|%01|%02|%03|%04|%05|%06|%07|%08|%09|%0a|%0b|%0c|%0d|%0e|%0f)",
      "flags": "i",
      "severity": 8,
      "action": "block",
      "message": "Encoding-based attack detected",
      "enabled": true,
      "category": "encoding_attack"
    },
    {
      "id": "WP_012",
      "name": "WordPress Backup File Access",
      "pattern": "(backup.*\\.(sql|zip|tar|gz)|.*\\.(bak|backup|old|orig))",
      "flags": "i",
      "severity": 8,
      "action": "block",
      "message": "Backup file access attempt",
      "enabled": true,
      "category": "information_disclosure"
    },
    {
      "id": "8G_011",
      "name": "8G Malformed User Agent",
      "pattern": "(^$|^-$|\\\\x[0-9a-f]{2}|[\\x00-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f])",
      "flags": "i",
      "severity": 7,
      "action": "block",
      "message": "Malformed or suspicious user agent",
      "enabled": true,
      "category": "malformed_request"
    }
  ],
  "whitelist_patterns": [
    {
      "id": "WL_001",
      "name": "Legitimate SEO Bots",
      "pattern": "(googlebot|bingbot|duckduckbot|baiduspider|yandexbot)",
      "enabled": true,
      "description": "Allow legitimate search engine bots"
    },
    {
      "id": "WL_002",
      "name": "Social Media Bots",
      "pattern": "(facebookexternalhit|twitterbot|linkedinbot|pinterest)",
      "enabled": true,
      "description": "Allow social media platform bots"
    }
  ],
  "rate_limiting": [
    {
      "id": "RL_001",
      "path": "wp-login.php",
      "max_requests": 5,
      "time_window": 300,
      "action": "block",
      "duration": 3600
    },
    {
      "id": "RL_002",
      "path": "xmlrpc.php",
      "max_requests": 10,
      "time_window": 60,
      "action": "block",
      "duration": 1800
    }
  ]
}

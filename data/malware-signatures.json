{
  "signatures": [
    {
      "id": "MW-001",
      "name": "Base64 Decode + Eval/Assert",
      "description": "Detects common obfuscated backdoors using base64 decoding and execution functions.",
      "pattern": "/base64_decode\\s*\\(\\s*['\"].+['\"]\\s*\\)\\s*;.*(eval|assert)/is",
      "severity": "critical"
    },
    {
      "id": "MW-002",
      "name": "FilesMan Backdoor",
      "description": "Detects the common 'FilesMan' backdoor.",
      "pattern": "/eval\\(gzuncompress\\(base64_decode\\('/is",
      "severity": "critical"
    },
    {
      "id": "MW-003",
      "name": "Direct Eval on POST/GET/REQUEST",
      "description": "Detects direct execution of user-supplied data, a common remote code execution vulnerability.",
      "pattern": "/eval\\s*\\(\\s*\\$_((POST|GET|REQUEST|COOKIE)\\[|SERVER\\[)/is",
      "severity": "critical"
    },
    {
      "id": "MW-004",
      "name": "Shell Exec/System Functions",
      "description": "Detects functions often used for shell command execution.",
      "pattern": "/(shell_exec|system|passthru|proc_open|popen)\\s*\\(/is",
      "severity": "high"
    },
    {
        "id": "MW-005",
        "name": "Create Function Obfuscation",
        "description": "Detects use of create_function, which can be used for obfuscation.",
        "pattern": "/create_function\\s*\\(/is",
        "severity": "medium"
    }
  ]
}
